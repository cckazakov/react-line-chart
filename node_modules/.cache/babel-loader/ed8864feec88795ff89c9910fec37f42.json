{"ast":null,"code":"import _classCallCheck from \"/Users/leonandrei/Documents/workspace/react/react-line-chart/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/leonandrei/Documents/workspace/react/react-line-chart/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/leonandrei/Documents/workspace/react/react-line-chart/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/leonandrei/Documents/workspace/react/react-line-chart/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/leonandrei/Documents/workspace/react/react-line-chart/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/leonandrei/Documents/workspace/react/react-line-chart/src/LineChart.js\";\nimport React from 'react';\nimport d3 from 'd3';\nimport './custom.css';\n\nvar LineChart =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LineChart, _React$Component);\n\n  function LineChart() {\n    _classCallCheck(this, LineChart);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LineChart).apply(this, arguments));\n  }\n\n  _createClass(LineChart, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.drawChart();\n    }\n  }, {\n    key: \"drawChart\",\n    value: function drawChart() {\n      console.log('draw chart');\n      var myData = \"date\tNew York\tSan Francisco\tAustin\\n\\\n                20111001\t63.4\t62.7\t72.2\\n\\\n                20111002\t58.0\t59.9\t67.7\\n\\\n                20111003\t53.3\t59.1\t69.4\\n\\\n                20111004\t55.7\t58.8\t68.0\\n\\\n                20111005\t64.2\t58.7\t72.4\\n\\\n                20111006\t58.8\t57.0\t77.0\\n\\\n                20111007\t57.9\t56.7\t82.3\\n\\\n                20111008\t61.8\t56.8\t78.9\\n\\\n                20111009\t69.3\t56.7\t68.8\\n\\\n                20111010\t71.2\t60.1\t68.7\\n\\\n                20111011\t68.7\t61.1\t70.3\\n\\\n                20111012\t61.8\t61.5\t75.3\\n\\\n                20111013\t63.0\t64.3\t76.6\\n\\\n                20111014\t66.9\t67.1\t66.6\\n\\\n                20111015\t61.7\t64.6\t68.0\\n\\\n                20111016\t61.8\t61.6\t70.6\\n\\\n                20111017\t62.8\t61.1\t71.1\\n\\\n                20111018\t60.8\t59.2\t70.0\\n\\\n                20111019\t62.1\t58.9\t61.6\\n\\\n                20111020\t65.1\t57.2\t57.4\\n\\\n                20111021\t55.6\t56.4\t64.3\\n\\\n                20111022\t54.4\t60.7\t72.4\\n\";\n      console.log(myData);\n      var margin = {\n        top: 20,\n        right: 80,\n        bottom: 30,\n        left: 50\n      },\n          width = 900 - margin.left - margin.right,\n          height = 500 - margin.top - margin.bottom;\n      var parseDate = d3.time.format(\"%Y%m%d\").parse;\n      var x = d3.time.scale().range([0, width]);\n      var y = d3.scale.linear().range([height, 0]);\n      var color = d3.scale.category10();\n      var xAxis = d3.svg.axis().scale(x).orient(\"bottom\");\n      var yAxis = d3.svg.axis().scale(y).orient(\"left\");\n      var line = d3.svg.line().interpolate(\"basis\").x(function (d) {\n        return x(d.date);\n      }).y(function (d) {\n        return y(d.temperature);\n      });\n      var svg = d3.select(\"#chart\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n      console.log('svg', svg);\n      var data = d3.tsv.parse(myData);\n      color.domain(d3.keys(data[0]).filter(function (key) {\n        return key !== \"date\";\n      }));\n      data.forEach(function (d) {\n        d.date = parseDate(d.date);\n      });\n      var cities = color.domain().map(function (name) {\n        return {\n          name: name,\n          values: data.map(function (d) {\n            return {\n              date: d.date,\n              temperature: +d[name]\n            };\n          })\n        };\n      });\n      x.domain(d3.extent(data, function (d) {\n        return d.date;\n      }));\n      y.domain([d3.min(cities, function (c) {\n        return d3.min(c.values, function (v) {\n          return v.temperature;\n        });\n      }), d3.max(cities, function (c) {\n        return d3.max(c.values, function (v) {\n          return v.temperature;\n        });\n      })]);\n      var legend = svg.selectAll('g').data(cities).enter().append('g').attr('class', 'legend');\n      legend.append('rect').attr('x', width - 20).attr('y', function (d, i) {\n        return i * 20;\n      }).attr('width', 10).attr('height', 10).style('fill', function (d) {\n        return color(d.name);\n      });\n      legend.append('text').attr('x', width - 8).attr('y', function (d, i) {\n        return i * 20 + 9;\n      }).text(function (d) {\n        return d.name;\n      });\n      svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(xAxis);\n      svg.append(\"g\").attr(\"class\", \"y axis\").call(yAxis).append(\"text\").attr(\"transform\", \"rotate(-90)\").attr(\"y\", 6).attr(\"dy\", \".71em\").style(\"text-anchor\", \"end\").text(\"Temperature (ÂºF)\");\n      var city = svg.selectAll(\".city\").data(cities).enter().append(\"g\").attr(\"class\", \"city\");\n      city.append(\"path\").attr(\"class\", \"line\").attr(\"d\", function (d) {\n        return line(d.values);\n      }).style(\"stroke\", function (d) {\n        return color(d.name);\n      });\n      city.append(\"text\").datum(function (d) {\n        return {\n          name: d.name,\n          value: d.values[d.values.length - 1]\n        };\n      }).attr(\"transform\", function (d) {\n        return \"translate(\" + x(d.value.date) + \",\" + y(d.value.temperature) + \")\";\n      }).attr(\"x\", 3).attr(\"dy\", \".35em\").text(function (d) {\n        return d.name;\n      });\n      var mouseG = svg.append(\"g\").attr(\"class\", \"mouse-over-effects\");\n      mouseG.append(\"path\") // this is the black vertical line to follow mouse\n      .attr(\"class\", \"mouse-line\").style(\"stroke\", \"black\").style(\"stroke-width\", \"1px\").style(\"opacity\", \"0\");\n      var lines = document.getElementsByClassName('line');\n      var mousePerLine = mouseG.selectAll('.mouse-per-line').data(cities).enter().append(\"g\").attr(\"class\", \"mouse-per-line\");\n      mousePerLine.append(\"circle\").attr(\"r\", 7).style(\"stroke\", function (d) {\n        return color(d.name);\n      }).style(\"fill\", \"none\").style(\"stroke-width\", \"1px\").style(\"opacity\", \"0\");\n      mousePerLine.append(\"text\").attr(\"transform\", \"translate(10,3)\");\n      mouseG.append('svg:rect') // append a rect to catch mouse movements on canvas\n      .attr('width', width) // can't catch mouse events on a g element\n      .attr('height', height).attr('fill', 'none').attr('pointer-events', 'all').on('mouseout', function () {\n        // on mouse out hide line, circles and text\n        d3.select(\".mouse-line\").style(\"opacity\", \"0\");\n        d3.selectAll(\".mouse-per-line circle\").style(\"opacity\", \"0\");\n        d3.selectAll(\".mouse-per-line text\").style(\"opacity\", \"0\");\n      }).on('mouseover', function () {\n        // on mouse in show line, circles and text\n        d3.select(\".mouse-line\").style(\"opacity\", \"1\");\n        d3.selectAll(\".mouse-per-line circle\").style(\"opacity\", \"1\");\n        d3.selectAll(\".mouse-per-line text\").style(\"opacity\", \"1\");\n      }).on('mousemove', function () {\n        // mouse moving over canvas\n        var mouse = d3.mouse(this);\n        d3.select(\".mouse-line\").attr(\"d\", function () {\n          var d = \"M\" + mouse[0] + \",\" + height;\n          d += \" \" + mouse[0] + \",\" + 0;\n          return d;\n        });\n        d3.selectAll(\".mouse-per-line\").attr(\"transform\", function (d, i) {\n          console.log(width / mouse[0]); // let xDate = x.invert(mouse[0]);\n          // let bisect = d3.bisector(function(d) { return d.date; }).right;\n          // let idx = bisect(d.values, xDate);\n\n          var beginning = 0,\n              end = lines[i].getTotalLength(),\n              target = null;\n\n          while (true) {\n            target = Math.floor((beginning + end) / 2);\n            var pos = lines[i].getPointAtLength(target);\n\n            if ((target === end || target === beginning) && pos.x !== mouse[0]) {\n              break;\n            }\n\n            if (pos.x > mouse[0]) end = target;else if (pos.x < mouse[0]) beginning = target;else break; //position found\n          }\n\n          d3.select(this).select('text').text(y.invert(pos.y).toFixed(2));\n          return \"translate(\" + mouse[0] + \",\" + pos.y + \")\";\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"chart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return LineChart;\n}(React.Component);\n\nexport default LineChart; // ReactDOM.render(<LineChart />, document.getElementById('app'))","map":{"version":3,"sources":["/Users/leonandrei/Documents/workspace/react/react-line-chart/src/LineChart.js"],"names":["React","d3","LineChart","drawChart","console","log","myData","margin","top","right","bottom","left","width","height","parseDate","time","format","parse","x","scale","range","y","linear","color","category10","xAxis","svg","axis","orient","yAxis","line","interpolate","d","date","temperature","select","append","attr","data","tsv","domain","keys","filter","key","forEach","cities","map","name","values","extent","min","c","v","max","legend","selectAll","enter","i","style","text","call","city","datum","value","length","mouseG","lines","document","getElementsByClassName","mousePerLine","on","mouse","beginning","end","getTotalLength","target","Math","floor","pos","getPointAtLength","invert","toFixed","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport d3 from 'd3';\nimport './custom.css';\n\nclass LineChart extends React.Component {\n  \n    componentDidMount() {\n        this.drawChart();\n    }\n    \n    drawChart() {\n      \n      console.log('draw chart');\n      \n      let myData = \"date\tNew York\tSan Francisco\tAustin\\n\\\n                20111001\t63.4\t62.7\t72.2\\n\\\n                20111002\t58.0\t59.9\t67.7\\n\\\n                20111003\t53.3\t59.1\t69.4\\n\\\n                20111004\t55.7\t58.8\t68.0\\n\\\n                20111005\t64.2\t58.7\t72.4\\n\\\n                20111006\t58.8\t57.0\t77.0\\n\\\n                20111007\t57.9\t56.7\t82.3\\n\\\n                20111008\t61.8\t56.8\t78.9\\n\\\n                20111009\t69.3\t56.7\t68.8\\n\\\n                20111010\t71.2\t60.1\t68.7\\n\\\n                20111011\t68.7\t61.1\t70.3\\n\\\n                20111012\t61.8\t61.5\t75.3\\n\\\n                20111013\t63.0\t64.3\t76.6\\n\\\n                20111014\t66.9\t67.1\t66.6\\n\\\n                20111015\t61.7\t64.6\t68.0\\n\\\n                20111016\t61.8\t61.6\t70.6\\n\\\n                20111017\t62.8\t61.1\t71.1\\n\\\n                20111018\t60.8\t59.2\t70.0\\n\\\n                20111019\t62.1\t58.9\t61.6\\n\\\n                20111020\t65.1\t57.2\t57.4\\n\\\n                20111021\t55.6\t56.4\t64.3\\n\\\n                20111022\t54.4\t60.7\t72.4\\n\";\n\n  console.log(myData);\n  \n      const margin = {\n          top: 20,\n          right: 80,\n          bottom: 30,\n          left: 50\n        },\n        width = 900 - margin.left - margin.right,\n        height = 500 - margin.top - margin.bottom;\n  \n      const parseDate = d3.time.format(\"%Y%m%d\").parse;\n  \n      const x = d3.time.scale()\n        .range([0, width]);\n  \n      const y = d3.scale.linear()\n        .range([height, 0]);\n  \n      let color = d3.scale.category10();\n  \n      let xAxis = d3.svg.axis()\n        .scale(x)\n        .orient(\"bottom\");\n  \n      let yAxis = d3.svg.axis()\n        .scale(y)\n        .orient(\"left\");\n  \n      let line = d3.svg.line()\n        .interpolate(\"basis\")\n        .x(function(d) {\n          return x(d.date);\n        })\n        .y(function(d) {\n          return y(d.temperature);\n        });\n  \n      let svg = d3.select(\"#chart\").append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n      \n      console.log('svg', svg); \n  \n      let data = d3.tsv.parse(myData);\n  \n      color.domain(d3.keys(data[0]).filter(function(key) {\n        return key !== \"date\";\n      }));\n  \n      data.forEach(function(d) {\n        d.date = parseDate(d.date);\n      });\n  \n      let cities = color.domain().map(function(name) {\n        return {\n          name: name,\n          values: data.map(function(d) {\n            return {\n              date: d.date,\n              temperature: +d[name]\n            };\n          })\n        };\n      });\n  \n      x.domain(d3.extent(data, function(d) {\n        return d.date;\n      }));\n  \n      y.domain([\n        d3.min(cities, function(c) {\n          return d3.min(c.values, function(v) {\n            return v.temperature;\n          });\n        }),\n        d3.max(cities, function(c) {\n          return d3.max(c.values, function(v) {\n            return v.temperature;\n          });\n        })\n      ]);\n  \n      let legend = svg.selectAll('g')\n        .data(cities)\n        .enter()\n        .append('g')\n        .attr('class', 'legend');\n  \n      legend.append('rect')\n        .attr('x', width - 20)\n        .attr('y', function(d, i) {\n          return i * 20;\n        })\n        .attr('width', 10)\n        .attr('height', 10)\n        .style('fill', function(d) {\n          return color(d.name);\n        });\n  \n      legend.append('text')\n        .attr('x', width - 8)\n        .attr('y', function(d, i) {\n          return (i * 20) + 9;\n        })\n        .text(function(d) {\n          return d.name;\n        });\n  \n      svg.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        .call(xAxis);\n  \n      svg.append(\"g\")\n        .attr(\"class\", \"y axis\")\n        .call(yAxis)\n        .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", 6)\n        .attr(\"dy\", \".71em\")\n        .style(\"text-anchor\", \"end\")\n        .text(\"Temperature (ÂºF)\");\n  \n      let city = svg.selectAll(\".city\")\n        .data(cities)\n        .enter().append(\"g\")\n        .attr(\"class\", \"city\");\n  \n      city.append(\"path\")\n        .attr(\"class\", \"line\")\n        .attr(\"d\", function(d) {\n          return line(d.values);\n        })\n        .style(\"stroke\", function(d) {\n          return color(d.name);\n        });\n  \n      city.append(\"text\")\n        .datum(function(d) {\n          return {\n            name: d.name,\n            value: d.values[d.values.length - 1]\n          };\n        })\n        .attr(\"transform\", function(d) {\n          return \"translate(\" + x(d.value.date) + \",\" + y(d.value.temperature) + \")\";\n        })\n        .attr(\"x\", 3)\n        .attr(\"dy\", \".35em\")\n        .text(function(d) {\n          return d.name;\n        });\n  \n      let mouseG = svg.append(\"g\")\n        .attr(\"class\", \"mouse-over-effects\");\n  \n      mouseG.append(\"path\") // this is the black vertical line to follow mouse\n        .attr(\"class\", \"mouse-line\")\n        .style(\"stroke\", \"black\")\n        .style(\"stroke-width\", \"1px\")\n        .style(\"opacity\", \"0\");\n        \n      let lines = document.getElementsByClassName('line');\n  \n      let mousePerLine = mouseG.selectAll('.mouse-per-line')\n        .data(cities)\n        .enter()\n        .append(\"g\")\n        .attr(\"class\", \"mouse-per-line\");\n  \n      mousePerLine.append(\"circle\")\n        .attr(\"r\", 7)\n        .style(\"stroke\", function(d) {\n          return color(d.name);\n        })\n        .style(\"fill\", \"none\")\n        .style(\"stroke-width\", \"1px\")\n        .style(\"opacity\", \"0\");\n  \n      mousePerLine.append(\"text\")\n        .attr(\"transform\", \"translate(10,3)\");\n  \n      mouseG.append('svg:rect') // append a rect to catch mouse movements on canvas\n        .attr('width', width) // can't catch mouse events on a g element\n        .attr('height', height)\n        .attr('fill', 'none')\n        .attr('pointer-events', 'all')\n        .on('mouseout', function() { // on mouse out hide line, circles and text\n          d3.select(\".mouse-line\")\n            .style(\"opacity\", \"0\");\n          d3.selectAll(\".mouse-per-line circle\")\n            .style(\"opacity\", \"0\");\n          d3.selectAll(\".mouse-per-line text\")\n            .style(\"opacity\", \"0\");\n        })\n        .on('mouseover', function() { // on mouse in show line, circles and text\n          d3.select(\".mouse-line\")\n            .style(\"opacity\", \"1\");\n          d3.selectAll(\".mouse-per-line circle\")\n            .style(\"opacity\", \"1\");\n          d3.selectAll(\".mouse-per-line text\")\n            .style(\"opacity\", \"1\");\n        })\n        .on('mousemove', function() { // mouse moving over canvas\n          let mouse = d3.mouse(this);\n          d3.select(\".mouse-line\")\n            .attr(\"d\", function() {\n              let d = \"M\" + mouse[0] + \",\" + height;\n              d += \" \" + mouse[0] + \",\" + 0;\n              return d;\n            });\n  \n          d3.selectAll(\".mouse-per-line\")\n            .attr(\"transform\", function(d, i) {\n              console.log(width/mouse[0])\n              // let xDate = x.invert(mouse[0]);\n              // let bisect = d3.bisector(function(d) { return d.date; }).right;\n              // let idx = bisect(d.values, xDate);\n              \n              let beginning = 0,\n                  end = lines[i].getTotalLength(),\n                  target = null;\n  \n              while (true){\n                target = Math.floor((beginning + end) / 2);\n                var pos = lines[i].getPointAtLength(target);\n                if ((target === end || target === beginning) && pos.x !== mouse[0]) {\n                    break;\n                }\n                if (pos.x > mouse[0])      end = target;\n                else if (pos.x < mouse[0]) beginning = target;\n                else break; //position found\n              }\n              \n              d3.select(this).select('text')\n                .text(y.invert(pos.y).toFixed(2));\n                \n              return \"translate(\" + mouse[0] + \",\" + pos.y +\")\";\n            });\n        });\n    }\n    \n    render() {\n      return  (\n        <div id=\"chart\">\n        </div>\n      )\n    }\n  }\n  \nexport default LineChart\n  // ReactDOM.render(<LineChart />, document.getElementById('app'))"]},"metadata":{},"sourceType":"module"}